---
title: GÃ©rer les erreurs avec try/catch et exceptions PDO
layout: home
nav_order: 4
parent: Connecter une application Ã  une base de donnÃ©es
permalink: /connecter-application-bdd/gestion-erreurs-pdo/
---


# ğŸ“˜ Chapitre â€“ GÃ©rer les erreurs avec try/catch et exceptions PDO

## 1. ğŸ¯ Objectif pÃ©dagogique

Savoir dÃ©tecter et gÃ©rer les erreurs liÃ©es aux opÃ©rations sur la base de donnÃ©es (connexion, requÃªtes SQL) en utilisant les **exceptions PDO** et les blocs **try/catch**.

## 2. ğŸ“š Concepts abordÃ©s

* Utilisation des blocs `try` et `catch` en PHP
* Gestion des exceptions `PDOException`
* Lâ€™option `PDO::ATTR_ERRMODE`
* Affichage contrÃ´lÃ© des messages dâ€™erreur
* Bonnes pratiques pour le **debugging** et la **sÃ©curitÃ©**

## 3. ğŸ§  Explication thÃ©orique

Lorsquâ€™une erreur survient (ex. mauvaise requÃªte SQL ou identifiants incorrects), PDO lÃ¨ve une **exception**.
En activant le mode exception avec :

```php
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
```

le code peut intercepter lâ€™erreur via un `try/catch`.

**Exemple simple :**

```php
try {
    $pdo = new PDO('mysql:host=localhost;dbname=test', 'root', '');
} catch (PDOException $e) {
    echo "Erreur : " . $e->getMessage();
}
```

## 4. ğŸ›  Tutoriel pratique

**RÃ©sumÃ© du travail** : Configurer PDO pour gÃ©rer les erreurs et tester un cas dâ€™Ã©chec de requÃªte.

### Ã‰tape 1 : Configurer la connexion

Dans `connexion.php` :

```php
<?php
try {
    $pdo = new PDO('mysql:host=localhost;dbname=blogdb', 'root', '');
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    echo "Connexion rÃ©ussie";
} catch (PDOException $e) {
    echo "Erreur de connexion : " . $e->getMessage();
}
```

### Ã‰tape 2 : Simuler une erreur de requÃªte

```php
try {
    $pdo->query("SELECT * FROM table_inexistante");
} catch (PDOException $e) {
    echo "Erreur SQL : " . $e->getMessage();
}
```

### Ã‰tape 3 : Enregistrer les erreurs (optionnel)

Pour plus de sÃ©curitÃ©, enregistrer lâ€™erreur dans un fichier log plutÃ´t que de lâ€™afficher :

```php
catch (PDOException $e) {
    file_put_contents('erreurs.log', $e->getMessage(), FILE_APPEND);
    echo "Une erreur est survenue. Contactez l'administrateur.";
}
```

## 5. ğŸ§¾ RÃ©sumÃ© et points-clÃ©s

* **try/catch** permet de gÃ©rer les erreurs sans interrompre le programme.
* `PDO::ATTR_ERRMODE` dÃ©finit comment PDO rÃ©agit aux erreurs (mode exception recommandÃ©).
* Pour la sÃ©curitÃ©, ne jamais afficher les messages dâ€™erreurs complets en production.
* Les logs sont essentiels pour diagnostiquer les problÃ¨mes.
