---
title: Interaction simple avec la base de donnÃ©es via PDO
layout: home
nav_order: 5
parent: Programmation orientÃ©e objet
permalink: /programmation-orientee-objet/interaction-bdd-pdo/
---

# ğŸ“˜ Chapitre â€“ Interaction simple avec la base de donnÃ©es via PDO

## 1. ğŸ¯ Objectif pÃ©dagogique

Apprendre Ã  effectuer des **requÃªtes SQL simples** (SELECT, INSERT, UPDATE, DELETE) via lâ€™extension **PDO** dans un contexte orientÃ© objet.

## 2. ğŸ“š Concepts abordÃ©s

* Connexion sÃ©curisÃ©e avec PDO
* RequÃªtes simples avec `query()` et `exec()`
* RequÃªtes prÃ©parÃ©es avec `prepare()` et `execute()`
* RÃ©cupÃ©ration des donnÃ©es avec `fetch()` et `fetchAll()`
* Gestion des exceptions et bonnes pratiques

## 3. ğŸ§  Explication thÃ©orique

PDO (PHP Data Objects) est une interface qui facilite la connexion et lâ€™exÃ©cution de requÃªtes sur diffÃ©rentes bases de donnÃ©es.
**Exemple de connexion :**

```php
try {
    $pdo = new PDO('mysql:host=localhost;dbname=blogdb;charset=utf8', 'root', '');
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    echo "Erreur : " . $e->getMessage();
}
```

**Exemple de SELECT :**

```php
$stmt = $pdo->query("SELECT * FROM articles");
$articles = $stmt->fetchAll(PDO::FETCH_ASSOC);
```

## 4. ğŸ›  Tutoriel pratique

**RÃ©sumÃ© du travail** : Mettre en place une classe `Database` et exÃ©cuter quelques requÃªtes via PDO.

**Arborescence projet :**

```
projet_poo_pdo/
 â”œâ”€â”€ Database.php
 â””â”€â”€ test_pdo.php
```

### Ã‰tape 1 : CrÃ©er la classe Database

```php
<?php
class Database {
    private $host = "localhost";
    private $db_name = "blogdb";
    private $username = "root";
    private $password = "";
    public $conn;

    public function getConnection() {
        $this->conn = null;
        try {
            $this->conn = new PDO(
                "mysql:host=" . $this->host . ";dbname=" . $this->db_name . ";charset=utf8",
                $this->username,
                $this->password
            );
            $this->conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        } catch (PDOException $e) {
            echo "Erreur de connexion : " . $e->getMessage();
        }
        return $this->conn;
    }
}
```

### Ã‰tape 2 : ExÃ©cuter un SELECT

```php
<?php
require 'Database.php';

$db = (new Database())->getConnection();
$stmt = $db->query("SELECT * FROM articles");

$articles = $stmt->fetchAll(PDO::FETCH_ASSOC);
foreach ($articles as $article) {
    echo $article['titre'] . " - " . $article['auteur'] . "<br>";
}
```

### Ã‰tape 3 : InsÃ©rer un nouvel enregistrement

```php
$sql = "INSERT INTO articles (titre, contenu, auteur) VALUES (:titre, :contenu, :auteur)";
$stmt = $db->prepare($sql);
$stmt->execute([
    'titre' => 'Nouveau post',
    'contenu' => 'Ceci est un article ajoutÃ© via PDO.',
    'auteur' => 'Admin'
]);
```

### Ã‰tape 4 : Mettre Ã  jour un enregistrement

```php
$stmt = $db->prepare("UPDATE articles SET auteur = :auteur WHERE id = :id");
$stmt->execute(['auteur' => 'Alice', 'id' => 1]);
```

### Ã‰tape 5 : Supprimer un enregistrement

```php
$stmt = $db->prepare("DELETE FROM articles WHERE id = :id");
$stmt->execute(['id' => 2]);
```

## 5. ğŸ§¾ RÃ©sumÃ© et points-clÃ©s

* **PDO** simplifie les interactions avec la base de donnÃ©es et offre une sÃ©curitÃ© accrue.
* **`prepare()` + `execute()`** Ã©vite les failles dâ€™injection SQL.
* **`fetch()`** rÃ©cupÃ¨re une ligne, **`fetchAll()`** rÃ©cupÃ¨re toutes les lignes.
* Le regroupement dans une classe `Database` facilite la maintenance et la rÃ©utilisation.
